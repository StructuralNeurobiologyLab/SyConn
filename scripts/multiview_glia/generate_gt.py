# -*- coding: utf-8 -*-
# SyConn - Synaptic connectivity inference toolkit
#
# Copyright (c) 2016 - now
# Max-Planck-Institute of Neurobiology, Munich, Germany
# Authors: Philipp Schubert, Joergen Kornfeld
from syconn.reps.super_segmentation_dataset import SuperSegmentationDataset
from syconn.handler.basics import write_obj2pkl
# ------------------------------------------------------------------------------
# example script for generating a ground truth SSD based on IDs (for coords
#  one has to query the corresponding ID from the desired KnossosDataset)
# based on j0126
glia_coords = [[2462, 3066, 1494], [7668, 10059, 1995], [7881, 4587, 876], [7504, 3031, 295], [2788, 4073, 4769],
               [4324, 7878, 4019], [4835, 9751, 3154], [4352, 7822, 3972], [3961, 2006, 2285], [1376, 6056, 1181],
               [4607, 9105, 3809], [1947, 8191, 5365], [6835, 8116, 1208], [735, 1279, 2223], [6043, 6896, 476],
               [3725, 8935, 1750], [2833, 6969, 1845], [7149, 1588, 1964], [4784, 8159, 1729], [6075, 6723, 3046],
               [3952, 3023, 2500], [3878, 5044, 3988], [6955, 5617, 312], [7167, 5072, 4055], [4057, 4057, 1554],
               [5495, 8028, 2392], [1940, 7803, 3247], [4404, 5743, 5076], [3752, 6577, 4782], [1930, 1865, 830],
               [5976, 977, 1601], [1297, 2021, 1517], [5629, 3887, 1769], [3366, 2004, 4590], [4502, 7457, 4047],
               [5540, 4529, 1017], [9424, 8165, 4337], [5622, 5076, 2408], [5331, 7836, 2277], [3522, 7081, 5010],
               [4044, 4773, 91], [3748, 7593, 4341], [2565, 6109, 1749], [3016, 9134, 4416], [2094, 10219, 2644],
               [1186, 8173, 844], [2455, 6847, 251], [5004, 3511, 1958], [5956, 466, 2594], [6003, 6665, 2620],
               [7948, 5028, 2155], [7144, 4076, 649], [5934, 5456, 1568], [4314, 9053, 4229], [2958, 5580, 3638],
               [4878, 8111, 3366], [7465, 2431, 3039], [10239, 5904, 3865], [3755, 4067, 2657], [1873, 3011, 145],
               [1831, 5448, 3512], [5119, 1472, 1915], [3330, 6420, 4559], [9114, 9586, 1751], [1213, 8171, 2179],
               [720, 10023, 4499], [7036, 5990, 844], [3704, 7345, 5226], [3021, 3035, 3983], [3860, 4207, 2174],
               [8101, 6096, 2484], [5644, 8913, 3295], [5256, 5641, 1246], [2875, 8728, 1773], [6073, 7020, 3302],
               [6405, 1520, 802], [6090, 5240, 104], [2218, 10567, 2489], [3298, 6324, 4777], [6318, 9039, 816],
               [5545, 3149, 4038], [2265, 1926, 2778], [4059, 8139, 937], [7167, 2583, 193], [790, 5806, 1909],
               [2650, 7778, 5555], [5084, 3872, 2650], [2430, 5119, 1319], [4007, 9115, 2840], [5047, 1761, 3945],
               [2846, 2236, 4721], [920, 1917, 1780], [2383, 3926, 1685], [5627, 3054, 1871], [3462, 5106, 4830],
               [6043, 6438, 2712], [4951, 4940, 1198], [1389, 4095, 2438], [7768, 4479, 2373], [3915, 8281, 3908],
               [7643, 3048, 3226], [2293, 8988, 4303], [1713, 8191, 1337],
               [4781, 10149, 1676], [7567, 5786, 2790], [5947, 6827, 112], [7866, 6129, 3187], [7935, 4475, 2728],
               [3925, 7057, 5092], [3599, 6705, 5049], [3711, 7962, 4659], [957, 8834, 4592], [4505, 3160, 3295],
               [2384, 8723, 4230], [2151, 5447, 2663], [2981, 4981, 5522], [5877, 1968, 1117], [1246, 5042, 656]]

# IDs based on /wholebrain/scratch/areaxfs3
glia_ids = [8149504, 12394501, 3523086, 716819, 28604954, 24511518, 19843617, 24324646,
            13013546, 6363693, 19840055, 27290170, 1938494, 10297412, 1543751, 7042125,
            7422544, 7724119, 4536922, 14339175, 13124207, 23760403, 1270390, 19767416,
            8367753, 11913868, 17016975, 31424660, 29199509, 5163177, 7615858, 7854770,
            8640627, 28141748, 24417974, 3879610, 27078852, 11259589, 14338767, 31880915,
            1055956, 26933461, 4318936, 27210457, 14969039, 4391644, 1720542, 10782758, 15182572,
            16583920, 11093755, 903933, 8647422, 24795273, 21414657, 19563778, 18185991, 24096010,
            10789134, 571151, 13788944, 15650584, 26649882, 9796385, 12238629, 27470118, 1000234,
            31888172, 26014513, 8533299, 11470473, 19753798, 4156235, 9639760, 19200342, 2855767,
            1169753, 14965595, 29172062, 4533087, 23397730, 15432553, 1993580, 526189, 8886129, 31974770, 15919989,
            6183805, 17217918, 23020416, 25716101, 7945095, 8425865, 10788746, 28798642, 14152592,
            5868433, 13460392, 10819502, 24601007, 18280371, 22335412, 1993653, 9941435, 13979071,
            1357193, 19030985, 16134612, 31887834, 31697388, 29549021, 27286495, 18345954,
            27112938, 16272875, 33843692, 2945519, 3554298]


if __name__ == "__main__":
    ssd_new = SuperSegmentationDataset(
        working_dir="/wholebrain/scratch/areaxfs3/", version="gliagt")
    # generate SSVs from single SVs:
    for k in glia_ids: ssd_new.mapping_dict[k] = [k]
    # save SSVs
    ssd_new.save_dataset_deep()
    gt_dir = "/wholebrain/scratch/areaxfs3//ssv_gliagt/"
    write_obj2pkl(gt_dir +"gliagt_labels.pkl", {k: 1 for k in
                                                             glia_ids})
    # Neuron GT is given by axon GT ...
    for ssv in ssd_new.ssvs:
        ssv.load_attr_dict()
        ssv._render_rawviews(nb_views=2, add_cellobjects=False)

